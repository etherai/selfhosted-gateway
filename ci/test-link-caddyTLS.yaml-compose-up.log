time="2024-02-27T14:47:57-06:00" level=warning msg="Found orphan containers ([ci-gateway-1 ci-gateway-sshd-1]) for this project. If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up."
 Container ci-nginx-1  Creating
 Container ci-link-1  Creating
 Container ci-nginx-1  Created
 Container ci-link-1  Created
Attaching to link-1, nginx-1
link-1   | + echo 'iGFnxeEwLfYxzmUJ93iEgMi9hDEUvOvo7SYFVcsw2VQ='
link-1   | + ip link add link0 type wireguard
link-1   | + wg set link0 private-key /etc/wireguard/link0.key
link-1   | + wg set link0 listen-port 18521
link-1   | + ip addr add 10.0.0.2/24 dev link0
link-1   | + ip link set link0 up
link-1   | + ip link set link0 mtu 1380
link-1   | + wg set link0 peer 'nSQw9FPwa2Z+5lbm7+3RhtKvxQjN0TUzvcnbZtWoOAc=' allowed-ips 10.0.0.1/32 persistent-keepalive 30 endpoint app-example-com:18521
link-1   | + '[' -z ]
link-1   | + echo 'Using caddy with SSL termination to forward traffic to app.'
link-1   | + '[' '!' -z x ]
link-1   | + echo 'Configure Caddy for use with TLS backend'
link-1   | + '[' '!' -z x ]
link-1   | + echo 'Skip TLS verification'
link-1   | Using caddy with SSL termination to forward traffic to app.
link-1   | Configure Caddy for use with TLS backend
link-1   | Skip TLS verification
link-1   | + cat
link-1   | + export 'EXPOSE=nginx:80 {
link-1   |          transport http {
link-1   |             tls
link-1   |             tls_insecure_skip_verify
link-1   |             read_buffer 8192
link-1   |          }
link-1   |        }'
link-1   | + CADDYFILE=/etc/Caddyfile
link-1   | + BASIC_AUTH=admin:admin
link-1   | + BASIC_AUTH_CONFIG=
link-1   | + TLS_INTERNAL_CONFIG=
link-1   | + '[[' '!' -z admin:admin ]]
link-1   | + echo admin:admin
link-1   | + cut -d: -f1
link-1   | + USERNAME=admin
link-1   | + echo admin:admin
link-1   | + cut -d: -f2
link-1   | + PASSWORD=admin
link-1   | + caddy hash-password --plaintext admin
nginx-1  | /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
nginx-1  | /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
nginx-1  | 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
nginx-1  | 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
nginx-1  | /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
nginx-1  | /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
nginx-1  | /docker-entrypoint.sh: Configuration complete; ready for start up
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: using the "epoll" event method
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: nginx/1.25.4
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: built by gcc 12.2.0 (Debian 12.2.0-14) 
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: OS: Linux 5.15.133.1-microsoft-standard-WSL2
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker processes
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 29
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 30
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 31
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 32
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 33
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 34
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 35
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 36
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 37
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 38
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 39
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 40
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 41
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 42
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 43
nginx-1  | 2024/02/27 20:47:58 [notice] 1#1: start worker process 44
link-1   | + HASHED_PASSWORD='$2a$14$xT94wvZ6t6w5r9hIRhc8DuVh1v0EMH./BDcssjxjjhE9o1GFCa6mm'
link-1   | + cat
link-1   | + BASIC_AUTH_CONFIG='            basicauth /* {
link-1   |                 admin $2a$14$xT94wvZ6t6w5r9hIRhc8DuVh1v0EMH./BDcssjxjjhE9o1GFCa6mm
link-1   |             }'
link-1   | + export BASIC_AUTH_CONFIG
link-1   | + '[' '!' -z x ]
link-1   | + cat
link-1   | + TLS_INTERNAL_CONFIG='        tls internal'
link-1   | + export TLS_INTERNAL_CONFIG
link-1   | + envsubst
link-1   | + caddy run --config /etc/Caddyfile
link-1   | {"level":"info","ts":1709066879.2670372,"msg":"using provided configuration","config_file":"/etc/Caddyfile","config_adapter":""}
link-1   | {"level":"warn","ts":1709066879.26873,"msg":"Caddyfile input is not formatted; run 'caddy fmt --overwrite' to fix inconsistencies","adapter":"caddyfile","file":"/etc/Caddyfile","line":2}
link-1   | {"level":"info","ts":1709066879.2697468,"logger":"admin","msg":"admin endpoint started","address":"localhost:2019","enforce_origin":false,"origins":["//localhost:2019","//[::1]:2019","//127.0.0.1:2019"]}
link-1   | {"level":"info","ts":1709066879.2701776,"logger":"tls.cache.maintenance","msg":"started background certificate maintenance","cache":"0xc00013b380"}
link-1   | {"level":"info","ts":1709066879.2794065,"logger":"http.auto_https","msg":"server is listening only on the HTTPS port but has no TLS connection policies; adding one to enable TLS","server_name":"srv0","https_port":8443}
link-1   | {"level":"info","ts":1709066879.2794309,"logger":"http.auto_https","msg":"enabling automatic HTTP->HTTPS redirects","server_name":"srv0"}
link-1   | {"level":"warn","ts":1709066879.297468,"logger":"pki.ca.local","msg":"installing root certificate (you might be prompted for password)","path":"storage:pki/authorities/local/root.crt"}
link-1   | {"level":"info","ts":1709066879.2997699,"msg":"warning: \"certutil\" is not available, install \"certutil\" with \"apt install libnss3-tools\" or \"yum install nss-tools\" and try again"}
link-1   | {"level":"info","ts":1709066879.299836,"msg":"define JAVA_HOME environment variable to use the Java trust"}
link-1   | {"level":"info","ts":1709066879.3475819,"msg":"certificate installed properly in linux trusts"}
link-1   | {"level":"info","ts":1709066879.347921,"logger":"http","msg":"enabling HTTP/3 listener","addr":":8443"}
link-1   | {"level":"info","ts":1709066879.348198,"logger":"http.log","msg":"server running","name":"srv0","protocols":["h1","h2","h3"]}
link-1   | {"level":"info","ts":1709066879.3482783,"logger":"http.log","msg":"server running","name":"remaining_auto_https_redirects","protocols":["h1","h2","h3"]}
link-1   | {"level":"info","ts":1709066879.3482854,"logger":"http","msg":"enabling automatic TLS certificate management","domains":["app.example.com"]}
link-1   | {"level":"info","ts":1709066879.3507721,"logger":"tls.obtain","msg":"acquiring lock","identifier":"app.example.com"}
link-1   | {"level":"info","ts":1709066879.3531294,"msg":"autosaved config (load with --resume flag)","file":"/root/.config/caddy/autosave.json"}
link-1   | {"level":"info","ts":1709066879.3531744,"msg":"serving initial configuration"}
link-1   | {"level":"info","ts":1709066879.3562357,"logger":"tls.obtain","msg":"lock acquired","identifier":"app.example.com"}
link-1   | {"level":"info","ts":1709066879.356314,"logger":"tls","msg":"cleaning storage unit","storage":"FileStorage:/root/.local/share/caddy"}
link-1   | {"level":"info","ts":1709066879.3564095,"logger":"tls.obtain","msg":"obtaining certificate","identifier":"app.example.com"}
link-1   | {"level":"info","ts":1709066879.356569,"logger":"tls","msg":"finished cleaning storage units"}
link-1   | {"level":"info","ts":1709066879.3598912,"logger":"tls.obtain","msg":"certificate obtained successfully","identifier":"app.example.com"}
link-1   | {"level":"info","ts":1709066879.359995,"logger":"tls.obtain","msg":"releasing lock","identifier":"app.example.com"}
link-1   | {"level":"warn","ts":1709066879.3603866,"logger":"tls","msg":"stapling OCSP","error":"no OCSP stapling for [app.example.com]: no OCSP server specified in certificate","identifiers":["app.example.com"]}
Gracefully stopping... (press Ctrl+C again to force)
 Container ci-link-1  Stopping
 Container ci-nginx-1  Stopping
 Container ci-nginx-1  Stopped
 Container ci-link-1  Killing
 Container ci-link-1  Stopped
 Container ci-link-1  Killed
canceled
